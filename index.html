<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teacher Timetables</title>
  <style>
    body { font-family: sans-serif; background: #f5f7fa; padding: 1rem; }
    .teacher-card {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
      margin-bottom: 2rem;
      padding: 1rem;
    }
    .teacher-card h2 {
      margin: 0 0 1rem;
      font-size: 1.25rem;
    }
    table.schedule {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    table.schedule th,
    table.schedule td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      vertical-align: middle;
      white-space: nowrap;
    }
    table.schedule th {
      background: #e3f2fd;
      font-size: 0.85rem;
      line-height: 1.2;
    }
    table.schedule tbody th {
      background: #bbdefb;
      text-align: left;
      font-weight: bold;
    }
    table.schedule td div {
      font-size: 0.9rem;
    }
  </style>
</head>
<body>

  <div id="schedules">Loading schedules…</div>

  <script>
  (async function(){
    const container = document.getElementById("schedules");
    let teachers;
    try {
      const res = await fetch("teacher_schedules.json");
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      teachers = await res.json();
    } catch(err) {
      container.innerHTML = `<p style="color:red">Error loading data: ${err.message}</p>`;
      console.error(err);
      return;
    }

    const names = Object.keys(teachers);
    if (!names.length) {
      container.innerHTML = "<p>No data found.</p>";
      return;
    }

    // derive the 19 slot-keys from the first teacher's Mo row
    const slots = Object.keys(teachers[names[0]].Mo);

    // day ordering
    const DAY_ABBR  = ["Mo","Tu","We","Th","Fr"];
    const DAY_LABEL = { Mo:"Monday", Tu:"Tuesday", We:"Wednesday", Th:"Thursday", Fr:"Friday" };

    container.innerHTML = "";

    names.forEach(name => {
      const week = teachers[name];
      const card = document.createElement("div");
      card.className = "teacher-card";

      // heading
      const h2 = document.createElement("h2");
      h2.textContent = "Nama Guru: " + name;
      card.appendChild(h2);

      // table
      const tbl = document.createElement("table");
      tbl.className = "schedule";

      // thead
      const thead = tbl.createTHead();
      const hr = thead.insertRow();
      hr.insertCell().outerHTML = "<th>Day</th>";
      slots.forEach(slot => {
        // split on hyphen or en-dash
        const [rawStart, rawEnd] = slot.split(/–|-/);
        const start = rawStart.trim().padStart(5,"0");
        const end   = rawEnd.trim().padStart(5,"0");
        const th = document.createElement("th");
        th.innerHTML = `${start}<br>–<br>${end}`;
        hr.appendChild(th);
      });

      // tbody
      const tbody = tbl.createTBody();
      DAY_ABBR.forEach(d => {
        const tr = tbody.insertRow();
        tr.insertCell().outerHTML = `<th>${DAY_LABEL[d]}</th>`;

        slots.forEach(slot => {
          const td = tr.insertCell();
          const arr = (week[d] && week[d][slot]) || [];
          if (arr.length) {
            // first element = class, last element = subject
            const cls = arr[0];
            const subj = arr[arr.length - 1];
            td.innerHTML = `<div>${cls} ${subj}</div>`;
          }
        });
      });

      card.appendChild(tbl);
      container.appendChild(card);
    });
  })();
  </script>

</body>
</html>